# Working with SQL

The project contains SQL files used to initialize the database (`src/main/resources/db/`). You can use Copilot to create new SQL files and add new data to the database.


## 001 - Adding a new Table

Create a new table "drugs" with the fields "id", "name", "description" and "price", to the `src/main/resources/db/h2/schema.sql` file.
Make sure you specifu that it is a H2 database.

<details>
<summary>Possible Flow</summary>

You can use a simple comment and the code editor completion for example

```sql
# add a new table "drugs" with the fields "id", "name", "description" and "price" using h2 database
```

> Note: _remove the comment before saving the file_

You can also use the Copilot Inline Chat and ask the same question.

The table should look like this:

```sql
CREATE TABLE drugs (
  id          INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name        VARCHAR(255),
  description VARCHAR(255),
  price       DECIMAL(10,2)
);
```

</details>

## 002 - Adding new Data

Save the `src/main/resources/db/h2/schema.sql`, and keep the file open, and open also the `src/main/resources/db/h2/data.sql` file.

Using Copilot add ten drugs to the database.

<details>
<summary>Possible Flow</summary>

1. Open the `src/main/resources/db/h2/data.sql` file
2. Open Copilot Chat and ask `@workspace add 10 drugs to the drugs table with fields id, name, description and price. use real life drug names`

The new data should look like this:

```sql
INSERT INTO drugs (id, name, description, price) VALUES (1, 'Aspirin', 'Pain reliever', 5.00);
INSERT INTO drugs (id, name, description, price) VALUES (2, 'Ibuprofen', 'Anti-inflammatory', 10.00);
INSERT INTO drugs (id, name, description, price) VALUES (3, 'Paracetamol', 'Pain reliever', 3.00);
INSERT INTO drugs (id, name, description, price) VALUES (4, 'Amoxicillin', 'Antibiotic', 15.00);
INSERT INTO drugs (id, name, description, price) VALUES (5, 'Ciprofloxacin', 'Antibiotic', 20.00);
INSERT INTO drugs (id, name, description, price) VALUES (6, 'Lisinopril', 'For high blood pressure', 25.00);
INSERT INTO drugs (id, name, description, price) VALUES (7, 'Simvastatin', 'For high cholesterol', 30.00);
INSERT INTO drugs (id, name, description, price) VALUES (8, 'Amlodipine', 'For high blood pressure', 35.00);
INSERT INTO drugs (id, name, description, price) VALUES (9, 'Metformin', 'For type 2 diabetes', 40.00);
INSERT INTO drugs (id, name, description, price) VALUES (10, 'Omeprazole', 'For acid reflux', 45.00);
```


</details>


## 003 - Adding a new REST Endpoint

Open the API Controller `src/main/java/com/example/demo/api/ApiController.java` and add a new endpoint to get all drugs.

<details>
<summary>Possible Flow</summary>

1. Open the `src/main/java/com/example/demo/api/ApiController.java` file
2. Open Copilot Inline chat and ask `Add a new endpoit /drugs that return the content of the drugs table sorted by price and return a list of map`

We use a map since the Drug entity does not exist, you can use Copilot to create the Drug entity and use it instead of the map.

</detail>